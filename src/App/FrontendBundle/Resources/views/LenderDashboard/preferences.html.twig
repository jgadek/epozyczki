{% extends "::base.html.twig" %}
{% block body %}

<div class="section">
    <div class="container">
        <div class="section-content-steps" id="get-loan-steps">
            <div class="section-content-steps-column">
                <div class="section-content-steps-column-content" onClick="location.href = '{{ url('app_frontend_lender_dashboard_index') }}'">
                    <div class="section-content-steps-column-content-text">Wnioski o pożyczkę</div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="section-content-steps-column active" onClick="location.href = '{{ url('app_frontend_lender_dashboard_preferences') }}'">
                <div class="section-content-steps-column-content">
                    <div class="section-content-steps-column-content-text">Twoje preferencje</div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="section-content-steps-column" onClick="location.href = '{{ url('app_frontend_lender_dashboard_account') }}'">
                <div class="section-content-steps-column-content">
                    <div class="section-content-steps-column-content-text">Twoje konto</div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="clear"></div>
        </div>

        <div class="clear"></div>
        <div class="section-content-wrapper" id="give-loan-creator">
            {{ form_start(form) }}
            <div class="section-content-wrapper-equalBox">
                <div class="section-content-wrapper-top">
                    <div class="section-content-wrapper-top-header">Udzielę pożyczki w przedziale:</div>
                    <div class="clear"></div>
                </div>
                <div class="sliderContainer">
                    <div id="loanAmountRange"></div>
                </div>
                <div class="section-content-wrapper-slider-labels">
                    <div class="section-content-wrapper-slider-labels-min">10 000 PLN</div>
                    <div class="section-content-wrapper-slider-labels-max">1 000 000 PLN</div>
                    <div class="clear"></div>
                </div>
                <div class="section-content-rangeWrapper">
                    <div class="section-content-rangeWrapper-box">
                        <div class="section-content-rangeWrapper-box-text">od</div>
                        <div class="section-content-rangeWrapper-box-input"><input type="text" id="loanAmountRangeMin" value="100000"></div>
                        <div class="section-content-rangeWrapper-box-text">do</div>
                        <div class="section-content-rangeWrapper-box-input"><input type="text" id="loanAmountRangeMax" value="800000"></div>
                        <div class="section-content-rangeWrapper-box-text bold">PLN</div>
                        <div class="section-content-rangeWrapper-box-question" title="Wybierz kwotę, jaką jesteś w stanie pożyczyć"></div>
                    </div>
                </div>
            </div>
            <div class="section-content-wrapper-equalBox">
                <div class="section-content-wrapper-top">
                    <div class="section-content-wrapper-top-header">Wymagam spłaty pożyczki w przedziale:</div>
                    <div class="clear"></div>
                </div>
                <div class="sliderContainer">
                    <div id="loanPeriodRange"></div>
                </div>
                <div class="section-content-wrapper-slider-labels">
                    <div class="section-content-wrapper-slider-labels-min">1 mc</div>
                    <div class="section-content-wrapper-slider-labels-max">36 mc</div>
                    <div class="clear"></div>
                </div>
                <div class="section-content-rangeWrapper">
                    <div class="section-content-rangeWrapper-box">
                        <div class="section-content-rangeWrapper-box-text">od</div>
                        <div class="section-content-rangeWrapper-box-input"><input type="text" id="loanPeriodRangeMin" value="7"></div>
                        <div class="section-content-rangeWrapper-box-text">do</div>
                        <div class="section-content-rangeWrapper-box-input"><input type="text" id="loanPeriodRangeMax" value="24"></div>
                        <div class="section-content-rangeWrapper-box-text bold">mc</div>
                        <div class="section-content-rangeWrapper-box-question" title="Wybierz okres, na jaki chcesz udzielić pożyczki"></div>
                    </div>
                </div>
            </div>
            <div class="clear"></div>
            <div class="section-content-wrapper-biggerBox">
                <div class="creator-content-biggerBox-content">
                    <div class="section-content-wrapper-top">
                        <div class="section-content-wrapper-top-header">Wymagam zabezpieczenia pożyczki w formie:</div>
                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                    <div id="give-loan-checkboxes">
                        <div class="smallerBox">
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.boolMortgage) }}<label for="{{ form.vars.name ~ '_' ~ form.boolMortgage.vars.name }}"><span></span>Hipoteka</label></div>
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.boolBillOfExchange) }}<label for="{{ form.vars.name ~ '_' ~ form.boolBillOfExchange.vars.name }}"><span></span>Weksel</label></div>
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.boolCreditInsurance) }}<label for="{{ form.vars.name ~ '_' ~ form.boolCreditInsurance.vars.name }}"><span></span>Ubezpieczenie pożyczki</label></div>
                        </div>
                        <div class="biggerBox">
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.boolGuarantor) }}<label for="{{ form.vars.name ~ '_' ~ form.boolGuarantor.vars.name }}"><span></span>Poręczenie osoby trzeciej</label></div>
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.bool777) }}<label for="{{ form.vars.name ~ '_' ~ form.bool777.vars.name }}"><span></span>777 - dobrowolne poddanie się egzekucji</label></div>
                            <div class="form-inputBox-checkboxBox">{{ form_widget(form.boolTakeOwnership) }}<label for="{{ form.vars.name ~ '_' ~ form.boolTakeOwnership.vars.name }}"><span></span>Przywłaszczenie nieruchomości na czas pożyczki</label></div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="clear"></div>
            <div class="section-content-wrapper-biggerBox">
                <div class="creator-content-biggerBox-content">
                    <div class="section-content-wrapper-top">
                        <div class="section-content-wrapper-top-header">Powiadomienia e-mail</div>
                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                    <div id="give-loan-checkboxes">

                        <div class="form-inputBox-checkboxBox">
                            {{ form_widget(form.boolEmailConfirm) }}
                            <label for="{{ form.vars.name ~ '_' ~ form.boolEmailConfirm.vars.name }}">
                                <span></span>Chcę otrzymywać powiadomienia o nowych wnioskach o pożyczkę zgodnych z moimi preferencjami
                            </label>
                        </div>

                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="section-content-wrapper-smallerBox rightAlign">
                <div class="section-content-wrapper-smallerBox-button bottom">
                    <input type="submit" class="darkButton" value="Aktualizuj"></div>
                <div class="clear"></div>
            </div>
            <div class="clear"></div>
            {{ form_end(form) }}
        </div>
    </div>
</div>
<div id="push"></div>
{% endblock %}
{% block javascripts %}
<script>
    $(document).ready(function() {
        $(document).ready(function() {
            $formName = '{{ form.vars.name }}';
            var $defAmountFromVal = parseInt($('#' + $formName + '_intCreditAmountFrom').val());
            var $defAmountToVal = parseInt($('#' + $formName + '_intCreditAmountTo').val());
            var $defPeriodFromVal = parseInt($('#' + $formName + '_intRepaymentTimeFrom').val());
            var $defPeriodToVal = parseInt($('#' + $formName + '_intRepaymentTimeTo').val());

            $('.section-content-rangeWrapper-box-question').tooltipster({
                animation: 'fade',
                delay: 50,
                theme: 'tooltipster-epozyczki',
                trigger: 'hover'
            });

            $("#loanAmountRange").slider({
                range: true,
                values: [$defAmountFromVal, $defAmountToVal],
                min: 10000,
                max: 1000000,
                animate: true,
                step: 1000,
                slide: function(event, ui) {
                    $("#loanAmountRangeMin").val(ui.values[ 0 ]);
                    $("#loanAmountRangeMax").val(ui.values[ 1 ]);
                }
            });

            $("#loanPeriodRange").slider({
                range: true,
                values: [$defPeriodFromVal, $defPeriodToVal],
                min: 1,
                max: 36,
                animate: true,
                step: 1,
                slide: function(event, ui) {
                    $("#loanPeriodRangeMin").val(ui.values[ 0 ]);
                    $("#loanPeriodRangeMax").val(ui.values[ 1 ]);
                }
            });

            $("#loanAmountRangeMin").val($('#' + $formName + '_intCreditAmountFrom').val());
            $("#loanAmountRangeMax").val($('#' + $formName + '_intCreditAmountTo').val());
            $("#loanPeriodRangeMin").val($('#' + $formName + '_intRepaymentTimeFrom').val());
            $("#loanPeriodRangeMax").val($('#' + $formName + '_intRepaymentTimeTo').val());

            $('form[name="' + $formName + '"]').submit(function() {
                var amountFrom = parseInt($("#loanAmountRangeMin").val());
                var amountTo = parseInt($("#loanAmountRangeMax").val());
                var periodFrom = parseInt($("#loanPeriodRangeMin").val());
                var periodTo = parseInt($("#loanPeriodRangeMax").val());
                $('#' + $formName + '_intCreditAmountFrom').val(amountFrom);
                $('#' + $formName + '_intCreditAmountTo').val(amountTo);
                $('#' + $formName + '_intRepaymentTimeFrom').val(periodFrom);
                $('#' + $formName + '_intRepaymentTimeTo').val(periodTo);
            });
        });
    });
</script>  
<script type="text/javascript">
    function generate(text, type) {
        var n = noty({
            text: text,
            type: type,
            dismissQueue: true,
            layout: 'topLeft',
            closeWith: ['click'],
            theme: 'relax',
            maxVisible: 10,
            animation: {
                open: 'animated bounceInLeft',
                close: 'animated bounceOutLeft',
                easing: 'swing',
                speed: 500
            }
        });
        console.log('html: ' + n.options.id);
    }

    function generateAll() {
        {% for error in errors %}
        generate('<div class="activity-item"> <i class="fa fa-exclamation-triangle text-danger"></i> <div class="activity"> {{ error }} </div> </div>', 'error');
        {% endfor %}
        {% for success in app.session.flashbag.get('success') %}
        generate('<div class="activity-item"> <i class="fa fa-check text-danger"></i> <div class="activity"> {{ success }} </div> </div>', 'success');
        {% endfor %}
    }
    generateAll();
</script>
{% endblock %}